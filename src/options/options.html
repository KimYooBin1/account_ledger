<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>계정 기록장 - 관리</title>
    <link rel="stylesheet" href="options.build.css" />
  </head>
  <body class="bg-gray-50">
    <!-- Header -->
    <div class="bg-blue-600 text-white p-6 shadow-lg">
      <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-bold">🔐 계정 기록장</h1>
        <p class="text-blue-100 mt-2">Account Ledger - 전체 계정 관리</p>
      </div>
    </div>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto p-6">
      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white p-6 rounded-lg shadow">
          <p class="text-gray-600 text-sm">총 계정</p>
          <p class="text-3xl font-bold text-blue-600 mt-2" id="totalAccounts">
            0
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
          <p class="text-gray-600 text-sm">경고</p>
          <p class="text-3xl font-bold text-red-600 mt-2" id="warningAccounts">
            0
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
          <p class="text-gray-600 text-sm">변경 주기</p>
          <p class="text-3xl font-bold text-purple-600 mt-2">
            <span id="currentPeriod">90</span>일
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
          <p class="text-gray-600 text-sm">알림</p>
          <p
            class="text-3xl font-bold text-green-600 mt-2"
            id="notificationStatus"
          >
            ON
          </p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="bg-white p-6 rounded-lg shadow mb-6">
        <h2 class="text-xl font-bold text-gray-800 mb-4">빠른 작업</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <!-- 수동 등록 -->
          <div class="border border-gray-200 rounded-lg p-4">
            <h3 class="font-semibold text-gray-800 mb-3">수동 계정 등록</h3>
            <input
              type="text"
              id="manualUrlInput"
              placeholder="https://example.com"
              class="w-full px-3 py-2 border border-gray-300 rounded mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
            <button
              id="addManualAccountBtn"
              class="w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"
            >
              등록하기
            </button>
          </div>

          <!-- CSV 가져오기 -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-semibold text-gray-800">CSV 파일 가져오기</h3>
              <button
                id="csvHelpBtn"
                class="group relative inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 focus:outline-none"
                aria-label="CSV 가져오기 도움말"
                title="CSV 내보내기 방법 보기"
              >
                <span class="text-xs font-bold">?</span>
                <!-- hover tooltip -->
                <div
                  id="csvHelpHover"
                  class="pointer-events-none absolute right-0 top-8 z-10 hidden group-hover:block w-72 rounded-md border border-gray-200 bg-white p-3 text-xs text-gray-700 shadow-lg"
                >
                  Chrome의 비밀번호 관리에서 내보낸 CSV 파일을 선택하세요.
                  자세한 단계는 버튼을 클릭해 확인할 수 있습니다.
                </div>
              </button>
            </div>

            <div
              id="csvHelpPanel"
              class="hidden mb-3 rounded-md border border-yellow-200 bg-yellow-50 p-3 text-sm text-gray-800"
            >
              <p class="font-semibold mb-2">CSV 내보내기 안내</p>
              <ol class="list-decimal list-inside space-y-1">
                <li>아래 버튼으로 비밀번호 관리자 페이지를 엽니다.</li>
                <li>
                  메뉴에서
                  <span class="font-medium"> 비밀번호 내보내기</span>를
                  선택합니다.
                </li>
                <li>
                  지시에 따라 CSV 파일을 저장한 뒤, 이 화면에서 해당 파일을
                  선택하고 <span class="font-medium">가져오기</span>를
                  클릭하세요.
                </li>
              </ol>
              <p class="text-xs text-gray-600 mt-2">
                참고: 확장에서 chrome:// 페이지를 자동으로 열 수 없을 수
                있습니다. 열리지 않으면 아래 링크를 복사해 주소창에 붙여넣기
                해주세요.
              </p>
              <div class="mt-2 flex items-center gap-2">
                <input
                  id="passwordManagerUrl"
                  type="text"
                  readonly
                  value="chrome://password-manager/settings"
                  class="flex-1 rounded border border-gray-300 bg-gray-50 px-2 py-1 text-xs"
                />
                <button
                  id="copyPasswordManagerUrlBtn"
                  class="px-2 py-1 text-xs rounded bg-gray-200 hover:bg-gray-300"
                >
                  복사
                </button>
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <input
                type="file"
                id="csvFileInput"
                accept=".csv"
                class="w-full text-sm"
              />
              <button
                id="importCsvBtn"
                class="w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition"
              >
                가져오기
              </button>
              <button
                id="openPasswordManagerBtn"
                class="w-full px-4 py-2 bg-gray-100 text-gray-800 rounded hover:bg-gray-200 transition"
                type="button"
              >
                Chrome 비밀번호 관리자 열기
              </button>
            </div>
          </div>

          <!-- 설정 -->
          <div class="border border-gray-200 rounded-lg p-4">
            <h3 class="font-semibold text-gray-800 mb-3">비밀번호 변경 주기</h3>
            <div class="flex items-center gap-2 mb-3">
              <input
                type="number"
                id="periodInput"
                min="1"
                max="365"
                value="90"
                class="flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <span class="text-gray-600">일</span>
            </div>
            <button
              id="savePeriodBtn"
              class="w-full px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition"
            >
              저장
            </button>
          </div>
        </div>
      </div>

      <!-- Accounts Table -->
      <div class="bg-white rounded-lg shadow">
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold text-gray-800">계정 목록</h2>
            <div class="flex items-center gap-4">
              <input
                type="text"
                id="searchInput"
                placeholder="도메인 검색..."
                class="px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <button
                id="refreshBtn"
                class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition"
              >
                새로고침
              </button>
            </div>
          </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="p-12 text-center">
          <div
            class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
          ></div>
          <p class="mt-4 text-gray-600">로딩 중...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden p-12 text-center">
          <p class="text-gray-600 text-lg">등록된 계정이 없습니다.</p>
          <p class="text-gray-500 text-sm mt-2">
            위의 수동 등록 또는 CSV 가져오기를 사용하세요.
          </p>
        </div>

        <!-- Accounts Table -->
        <div id="accountsTableContainer" class="hidden overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-50 border-b border-gray-200">
              <tr>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  도메인
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  가입일
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  마지막 로그인
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  비밀번호 변경일
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  상태
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  작업
                </th>
              </tr>
            </thead>
            <tbody
              id="accountsTableBody"
              class="bg-white divide-y divide-gray-200"
            >
              <!-- 동적으로 생성됨 -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Edit Modal -->
    <div
      id="editModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
    >
      <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
        <h3 class="text-xl font-bold text-gray-800 mb-4">계정 정보 수정</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >도메인</label
            >
            <input
              type="text"
              id="editDomain"
              disabled
              class="w-full px-3 py-2 border border-gray-300 rounded bg-gray-50"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >가입일</label
            >
            <input
              type="datetime-local"
              id="editSignUpDate"
              class="w-full px-3 py-2 border border-gray-300 rounded"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >마지막 로그인</label
            >
            <input
              type="datetime-local"
              id="editLastLoginDate"
              class="w-full px-3 py-2 border border-gray-300 rounded"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >비밀번호 변경일</label
            >
            <input
              type="datetime-local"
              id="editLastPasswordChangeDate"
              class="w-full px-3 py-2 border border-gray-300 rounded"
            />
          </div>
        </div>
        <div class="mt-6 flex gap-3">
          <button
            id="saveEditBtn"
            class="flex-1 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"
          >
            저장
          </button>
          <button
            id="cancelEditBtn"
            class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition"
          >
            취소
          </button>
        </div>
      </div>
    </div>

    <script src="options.js" type="module"></script>
  </body>
</html>
